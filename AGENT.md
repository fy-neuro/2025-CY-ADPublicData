# AGENT.md

## 🎯 AI助手配置

### 基本信息
- **名称**: 生物学数据分析AI助手
- **版本**: 2026.01.04
- **专业领域**: 单细胞转录组学、空间转录组学、生物信息学
- **主要工具**: Seurat、Presto、R、Python、edgeR、DESeq2

### 核心能力
- **单细胞数据分析**: Seurat v5、细胞类型注释、差异表达分析
- **批量转录组分析**: DESeq2、edgeR、limma
- **空间转录组分析**: Visium、Slide-seq、空间统计分析
- **基因富集分析**: GO、KEGG、Reactome、GSEA
- **网络分析**: 细胞间通讯、基因调控网络、共表达网络
- **可视化**: ggplot2、ComplexHeatmap、seurat可视化、空间图表

---

## 📁 项目结构

```
/media/bigbaby/Zhang-1号/Projects/Others/20251120-CY-ADpublic_data/
├── data/                           # 原始数据
│   ├── GSE138852/                 # 小鼠单细胞AD数据
│   └── GSE188545/                 # 人类单细胞AD数据
├── analysis/                       # 分析代码
│   ├── ad_studies/                 # AD疾病研究
│   ├── data_processing/             # 数据处理流程
│   └── visualization/              # 可视化代码
├── results/                       # 分析结果
├── task/                          # 临时任务目录
│   ├── 20251202-gene_plot/        # 基因绘图任务
│   ├── 20251204-space_analysis/    # 空间分析任务
│   ├── 20260103-presto_comparison/  # Presto比较分析
│   └── 20260104-ECM_comparison_wilcoxauc_pseudobulk/  # ECM基因比较分析
└── documents/                     # 文档和报告
```

---

## 🧬 当前项目状态

### 主要项目: 阿尔茨海默病单细胞分析
#### 数据集概览
1. **GSE138852**: 小鼠模型AD单细胞数据
   - 9个样本，4种条件
   - 细胞类型: 小胶质细胞、星形胶质细胞、神经元等
   
2. **GSE188545**: 人类AD脑单细胞数据
   - 62,263个细胞，28,300个基因
   - 细胞类型: 神经元、胶质细胞、内皮细胞等

#### 研究方向
1. **细胞间通讯分析**
   - ECM相关基因分析
   - 配体-受体相互作用
   - 病理状态下的通讯变化

2. **差异表达分析**
   - Presto包性能评估
   - 传统方法vs现代方法比较
   - Pseudobulk分析挑战

3. **方法学开发**
   - 优化单细胞分析流程
   - 开发自定义分析工具
   - 数据结构兼容性解决方案

---

## 🛠️ 技术栈

### R环境
- **Seurat v5**: 单细胞分析主要工具
- **Presto**: 快速差异表达分析
- **edgeR/DESeq2**: 批量差异表达
- **dplyr/tidyr**: 数据处理
- **ggplot2**: 可视化
- **ComplexHeatmap**: 复杂热图
- **patchwork**: 图表组合

### Python环境
- **scanpy/anndata**: 单细胞数据处理
- **pandas/numpy**: 数据分析
- **matplotlib/seaborn**: 可视化
- **scikit-learn**: 机器学习

### 生信工具
- **CellChat**: 细胞间通讯分析
- **NicheNet**: 信号通路分析
- **SCENIC**: 转录调控网络
- **GSEA**: 基因富集分析

---

## 📊 已完成的主要任务

### 2025年11-12月: 基础数据分析和可视化
- ✅ GSE138852和GSE188545数据预处理
- ✅ 细胞类型注释和质量控制
- ✅ 基本统计分析和可视化
- ✅ 差异表达基因分析

### 2026年1月: 高级分析方法研究
- ✅ **Presto包综合研究**
  - 性能基准测试
  - 与传统方法比较
  - 最佳实践指南
  - 技术文档撰写

- ✅ **ECM通信基因分析**
  - 49个ECM通信V3基因的wilcoxauc分析
  - 8种细胞类型的全面分析
  - 发现ECM基因在AD中的显著稳定性
  - 生成完整的科学报告

- ❌ **Pseudobulk分析挑战**
  - DESeq2和edgeR兼容性问题
  - Seurat数据结构特殊性问题
  - 需要开发自定义解决方案
  - 详细的调试日志和技术文档

---

## 🔍 当前技术挑战

### 1. Pseudobulk分析兼容性
**问题描述**: 
- Seurat对象存在特殊的数据结构（每样本独立计数层）
- 标准pseudobulk工具无法处理此类数据
- 需要手动聚合方法

**已尝试的解决方案**:
- 样本ID格式转换
- 设计矩阵手动创建
- DGEList维度修复
- 手动计数聚合开发

**下一步计划**:
- 完成手动pseudobulk实现
- 开发通用数据预处理流程
- 创建兼容性检查工具

### 2. 大规模数据可视化
**挑战**:
- 60K+细胞的高效可视化
- 多样本条件下的图表整合
- 交互式可视化需求

---

## 📚 知识库

### 单细胞分析最佳实践
1. **质量控制**: 线粒体基因比例、核糖体基因比例、UMI/基因数量
2. **归一化**: SCTransform vs LogNormalize选择标准
3. **细胞类型注释**: 标记基因验证、多方法交叉验证
4. **差异表达**: 单细胞vs pseudobulk方法选择

### 疾病数据分析要点
1. **批次效应**: 多样本间批次识别和校正
2. **细胞状态识别**: 疾病特异性细胞状态
3. **通路分析**: 疾病相关通路富集
4. **验证策略**: 独立数据集验证

---

## 🔄 工作流程

### 标准分析流程
```
1. 数据加载 → 2. 质量控制 → 3. 归一化 → 4. 降维 
→ 5. 聚类 → 6. 细胞类型注释 → 7. 差异表达 → 8. 功能分析 → 9. 可视化
```

### 疾病分析流程
```
1. 条件对比 → 2. 差异基因 → 3. 通路富集 → 4. 细胞间通讯 
→ 5. 空间定位 → 6. 验证分析 → 7. 生物学解释
```

---

## 📈 性能指标

### 分析速度基准
- **Presto**: ~10秒/万细胞 (差异表达)
- **Seurat FindMarkers**: ~30秒/万细胞
- **DESeq2**: ~60秒/样本 (批量数据)

### 内存使用
- **60K细胞**: ~8-12GB内存
- **建议配置**: 16GB+内存，多核CPU

---

## 🎯 未来目标

### 短期目标 (1-2周)
1. 完成pseudobulk分析的手动实现
2. ECM基因分析的完整验证
3. 方法学比较报告的撰写

### 中期目标 (1-2月)
1. 开发通用的单细胞分析工具包
2. 空间转录组数据分析流程建立
3. 多数据集整合分析框架

### 长期目标 (3-6月)
1. AD疾病机制的深入研究
2. 药物靶点预测和验证
3. 临床转化研究的准备

---

## 📞 联系方式

### 项目相关
- **主要研究者**: CY博士
- **数据存储**: `/media/bigbaby/Zhang-1号/Projects/Others/20251120-CY-ADpublic_data/`
- **备份策略**: 定期备份到云端存储

### 技术支持
- **R环境**: 使用Bioconductor和CRAN最新版本
- **Python环境**: 基于conda的虚拟环境管理
- **计算资源**: 本地高性能计算集群

---

## 📝 更新日志

### 2026.01.04 - ECM基因比较分析
- ✅ 完成Presto包综合研究
- ✅ 成功执行ECM通信V3基因的wilcoxauc分析
- ❌ 遇到pseudobulk分析技术挑战
- 📝 生成详细的调试日志和技术报告

### 2026.01.03 - Presto包比较分析
- ✅ Presto vs 传统方法性能比较
- ✅ 多种数据集测试
- ✅ 最佳实践指南制定

### 2025.12 - 基础数据分析和可视化
- ✅ GSE138852和GSE188545数据完整处理
- ✅ 基础统计分析和可视化
- ✅ 差异表达分析

---

*最后更新: 2026年1月4日*